<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="会熟练拼写Python、Java、React"><title>JS-自定义事件触发在React中使用-高度自适应例 | 一点知识</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">JS-自定义事件触发在React中使用-高度自适应例</h1><a id="logo" href="/.">一点知识</a><p class="description">xukf</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/diary/"><i class="fa fa-book"> 日志</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">JS-自定义事件触发在React中使用-高度自适应例</h1><div class="post-meta">Jan 2, 2019<span> | </span><span class="category"><a href="/categories/前端/">前端</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2,406</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 11</span><span class="post-meta-item-text"> 分钟</span></span></span><script type="text/javascript" src="/js/love.js"></script></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#通过JS事件触发Echarts图表调整大小"><span class="toc-number">1.</span> <span class="toc-text">通过JS事件触发Echarts图表调整大小</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#实现方式"><span class="toc-number">1.1.</span> <span class="toc-text">实现方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#缺点"><span class="toc-number">1.2.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CSS实现高度自适应"><span class="toc-number">2.</span> <span class="toc-text">CSS实现高度自适应</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#缺点-1"><span class="toc-number">2.1.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#借助React生命周期实现高度自适应"><span class="toc-number">3.</span> <span class="toc-text">借助React生命周期实现高度自适应</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#缺点-2"><span class="toc-number">3.1.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#结合自定义的事件触发"><span class="toc-number">4.</span> <span class="toc-text">结合自定义的事件触发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#主题接口（Subject）"><span class="toc-number">4.1.</span> <span class="toc-text">主题接口（Subject）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主题（发布者）"><span class="toc-number">4.2.</span> <span class="toc-text">主题（发布者）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#观察者（订阅者）"><span class="toc-number">4.3.</span> <span class="toc-text">观察者（订阅者）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#思考"><span class="toc-number">4.4.</span> <span class="toc-text">思考</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考文章"><span class="toc-number">5.</span> <span class="toc-text">参考文章</span></a></li></ol></div></div><div class="post-content"><p><code>JS</code>与<code>HTML</code>的交互是通过事件来实现的。<br>近期在<code>React</code>项目中遇到了一个需求，使用Echarts画出的图表要根据页面大小进行自适应。  </p>
<a id="more"></a>
<h1 id="通过JS事件触发Echarts图表调整大小"><a href="#通过JS事件触发Echarts图表调整大小" class="headerlink" title="通过JS事件触发Echarts图表调整大小"></a>通过JS事件触发Echarts图表调整大小</h1><ul>
<li><p>JS已有事件<br>JS提供了<code>resize</code>事件：</p>
<blockquote>
<p>当浏览器窗口被调整到一个新的高度或者宽度时，就会触发resize事件。这个事件在window上面触发。</p>
</blockquote>
</li>
<li><p>Echarts给出了<a href="http://echarts.baidu.com/api.html#echartsInstance.resize" target="_blank" rel="noopener">echartsInstance.resize</a>方法：</p>
<blockquote>
<p>改变图表尺寸，在容器大小发生改变时需要手动调用。</p>
</blockquote>
</li>
</ul>
<p>因此，可以在Echarts实例初始化之后，绑定对<code>window.resize</code>事件的监听，每当<code>window.resize</code>事件触发，便回调Echarts的<code>echartsInstance.resize</code>方法，来实现Echarts图表的自适应。</p>
<h2 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h2><p>为了保证处理事件能在大多数浏览器下一致地运行，我们参考《JavaScript高级程序设计》方法，对事件绑定与解除进行封装，独立出单独的js文件–<code>public/DOMEventUtil.js</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  addHandler: <span class="function">(<span class="params">element, type, handler</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (element.addEventListener) &#123;</span><br><span class="line">      element.addEventListener(type, handler, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.attachEvent) &#123;</span><br><span class="line">      element.attachEvent(<span class="string">`on<span class="subst">$&#123;type&#125;</span>`</span>, handler);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(element, <span class="string">`on<span class="subst">$&#123;type&#125;</span>`</span>, &#123;</span><br><span class="line">        value: handler</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  removeHandler: <span class="function">(<span class="params">element, type, handler</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (element.removeEventListener) &#123;</span><br><span class="line">      element.removeEventListener(type, handler, <span class="literal">false</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (element.detachEvent) &#123;</span><br><span class="line">      element.detachEvent(<span class="string">`on<span class="subst">$&#123;type&#125;</span>`</span>, handler);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(element, <span class="string">`on<span class="subst">$&#123;type&#125;</span>`</span>, &#123;</span><br><span class="line">        value: <span class="literal">null</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>我们在需要Echarts图表自适应的js/jsx文件中引入该js文件，并将Echarts实例绑定上<code>window.resize</code>事件，比如Echarts地图大小的调整<code>mapInfo/DMMap.jsx</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> DOMEventUtil <span class="keyword">from</span> <span class="string">'../public/DOMEventUtil'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Echarts 实例化函数</span></span><br><span class="line">echartsDraw(mapId) &#123;</span><br><span class="line">  <span class="keyword">const</span> mapDiv = <span class="built_in">document</span>.getElementById(mapId);</span><br><span class="line">  <span class="keyword">const</span> myCharts = echarts.init(mapDiv);</span><br><span class="line">  DOMEventUtil.addHandler(<span class="built_in">window</span>, <span class="string">'resize'</span>, () =&gt; &#123; myCharts.resize(); &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这样就能在页面大小变化的时候，自动触发Echarts的大小调整函数来跟随页面实现自适应。</p>
<h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><p>这种方式面对的问题是：Echarts的实例容器一般是要求具有一定高度，如果固定了高度，那么该方法只能实现宽度变化的自适应，无法满足高度变化的自适应。</p>
<p>为了解决高度固定的问题，想到了用css来实现高度自适应。</p>
<h1 id="CSS实现高度自适应"><a href="#CSS实现高度自适应" class="headerlink" title="CSS实现高度自适应"></a>CSS实现高度自适应</h1><p>CSS巨渣，各位看官可以搜索一下<code>css padding-bottom</code>等等，会发现CSS能提供一个高度能随着页面大小自动变化的功能。  </p>
<p>似乎是看到了希望，但是Echarts在<a href="http://echarts.baidu.com/api.html#echarts.init" target="_blank" rel="noopener">echarts.init中有这么一条规则</a>：</p>
<blockquote>
<p>注：如果div是隐藏的，ECharts 可能会获取不到div的高宽导致初始化失败，这时候可以明确指定div的style.width和style.height，或者在div显示后手动调用 echartsInstance.resize 调整尺寸。</p>
</blockquote>
<h2 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h2><p>问题就是，使用CSS的<code>padding-bottom</code>等方法在不显示指定<code>div</code>的高度的时候，Echarts会初始化失败。</p>
<p>对于CSS不熟，能想到解决该问题的方案是在每次触发<code>window.resize</code>事件之后计算div的高度，通过明确指定div的<code>style.height</code>，再调用Echarts的<code>resize</code>来重新渲染图表。</p>
<p>这种方案深入思考一下，其实可以抛弃CSS实现的高度自适应，直接通过JS来实时计算div该有的高度来完成高度自适应。</p>
<h1 id="借助React生命周期实现高度自适应"><a href="#借助React生命周期实现高度自适应" class="headerlink" title="借助React生命周期实现高度自适应"></a>借助React生命周期实现高度自适应</h1><p>在React生命周期中，初次加载完成的<code>componentDidMount()</code>与组件更新完成的<code>componentDidUpdate()</code>都是在<code>render</code>渲染完才执行的。  </p>
<p>由于不想在每个组件中都计算目前页面的高度与宽度，所以把计算方法单独成一个方法，将目前的高度与宽度存放在Redux中。方法组件为<code>calcScreenSize/CalcScreenSize.jsx</code>：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'prop-types'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Actions <span class="keyword">from</span> <span class="string">'./Action'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DOMEventUtil <span class="keyword">from</span> <span class="string">'../public/DOMEventUtil'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CalcScreenSize</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; changeScreenSize &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    DOMEventUtil.addHandler(<span class="built_in">window</span>, <span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      changeScreenSize(<span class="built_in">window</span>.innerWidth, <span class="built_in">window</span>.innerHeight);</span><br><span class="line">    &#125;);</span><br><span class="line">    DOMEventUtil.addHandler(<span class="built_in">window</span>, <span class="string">'resize'</span>, () =&gt; &#123;</span><br><span class="line">      changeScreenSize(<span class="built_in">window</span>.innerWidth, <span class="built_in">window</span>.innerHeight);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CalcScreenSize.propTypes = &#123;</span><br><span class="line">  changeScreenSize: PropTypes.func.isRequired,</span><br><span class="line">  widthSize: PropTypes.number.isRequired,</span><br><span class="line">  heightSize: PropTypes.number.isRequired</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    widthSize: state.calcScreenSize.widthSize,</span><br><span class="line">    heightSize: state.calcScreenSize.heightSize</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    changeScreenSize: <span class="function">(<span class="params">widthSize, heightSize</span>) =&gt;</span> &#123;</span><br><span class="line">      dispatch(Actions.changeScreenSize(widthSize, heightSize));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(CalcScreenSize);</span><br></pre></td></tr></table></figure></p>
<p>calcScreenSize/Reducer：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> ActionTypes <span class="keyword">from</span> <span class="string">'./ActionTypes'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initValues = &#123;</span><br><span class="line">  widthSize: <span class="number">1366</span>,</span><br><span class="line">  heightSize: <span class="number">736</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state = initValues, action) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; widthSize, heightSize &#125; = action;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">  <span class="keyword">case</span> ActionTypes.CHANGE_SCREENSIZE:</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      ...state,</span><br><span class="line">      widthSize,</span><br><span class="line">      heightSize</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>其他需要图表自适应的组件都接收<code>widthSize</code>与<code>heightSize</code>参数，这样就能在<code>CalcScreenSize</code>动态计算出宽与高的时候能够触发zi自己的<code>componentWillReceiveProps()</code>，从而会触发<code>render</code>根据当前高度重新渲染div，并且能够在<code>componentDidUpdate()</code>中调用Echarts的<code>resize</code>实现图表的自适应。<br>render中重新确定div高度的代码如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; heightSize &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div id=<span class="string">"fileInfoMapShow"</span> style=&#123;&#123; <span class="attr">height</span>: <span class="string">`<span class="subst">$&#123;heightSize <span class="regexp">/ 12 * 10&#125;px`, width: '100%' &#125;&#125;&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">      等待地图加载</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">    &lt;/</span>div&gt;</span></span></span><br><span class="line"><span class="string"><span class="subst">  );</span></span></span><br><span class="line"><span class="string"><span class="subst">&#125;</span></span></span><br></pre></td></tr></table></figure></p>
<h2 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h2><p>这里存在的问题主要有两个：</p>
<ul>
<li>一是，由于需要图表自适应的组件所接受的props参数不只<code>widthSize</code>与<code>heightSize</code>，所以其他props参数的变化也会进入到<code>componentDidUpdate()</code>中，也会调用Echarts的<code>resize</code>方法，导致图表额外的自适应。</li>
<li>二是，如果原代码逻辑是在<code>componentWillReceiveProps()</code>获取到最新数据后更新Echarts图表数据，那么，在只变动<code>widthSize</code>与<code>heightSize</code>的情况下，除了引起Echarts的自适应，也会引起图表的更新。</li>
</ul>
<p>针对这两个问题，可以通过在<code>componentDidUpdate()</code>与<code>componentWillReceiveProps()</code>中加更新限制条件来解决。不过加条件的方式提高了单个组件的前台代码逻辑复杂度，并且需要在每个组件中都添加相同的逻辑判断。</p>
<h1 id="结合自定义的事件触发"><a href="#结合自定义的事件触发" class="headerlink" title="结合自定义的事件触发"></a>结合自定义的事件触发</h1><p>这种方式是考虑上面方案存在的问题给出的自己设想的解决方案。<br>简单的来讲，自适应大小这个功能主要是实现当页面大小改变，需要根据页面大小调整自身图表大小的Echarts实例完成自适应。这比较像观察者模式，或者说发布-订阅模式：</p>
<ul>
<li>将页面信息抽象出来成为组件，并看作为主题</li>
<li>将待自适应的Echarts图表作为多个观察者</li>
<li>待自适应的Echarts图表注册：监听页面大小变化</li>
<li>当页面大小发生变化时，页面信息组件通知到每个已注册监该事件的Echarts图表，实现图表的自适应</li>
</ul>
<h2 id="主题接口（Subject）"><a href="#主题接口（Subject）" class="headerlink" title="主题接口（Subject）"></a>主题接口（Subject）</h2><p>screenSizeChangeEvent.js：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EventTarget</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">EventTarget.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: EventTarget,</span><br><span class="line">  handlers: &#123;&#125;, <span class="comment">// 共享注册列表，方便多位置调用</span></span><br><span class="line">  addHandler(type, handler) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.handlers[type] === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.handlers[type] = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.handlers[type].push(handler);</span><br><span class="line">  &#125;,</span><br><span class="line">  execute(event) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.handlers[event.type] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> handlers = <span class="keyword">this</span>.handlers[event.type];</span><br><span class="line">      handlers.forEach(<span class="function">(<span class="params">handlerItem</span>) =&gt;</span> &#123;</span><br><span class="line">        handlerItem();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  remmoveHandler(type, handler) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.handlers[type] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> handlers = <span class="keyword">this</span>.handlers[type];</span><br><span class="line">      <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">const</span> len = handlers.length;</span><br><span class="line">      <span class="keyword">while</span> (i &lt; len) &#123;</span><br><span class="line">        <span class="keyword">if</span> (handlers[i] === handler) &#123;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        i += <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      handlers.splice(i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; EventTarget &#125;;</span><br></pre></td></tr></table></figure></p>
<p>使用原型模式创建主题接口对象，这样可以实现注册列表（handlers）的共享，只要创建该接口对象，就可以获取到相关主题已注册的对象列表。  </p>
<h2 id="主题（发布者）"><a href="#主题（发布者）" class="headerlink" title="主题（发布者）"></a>主题（发布者）</h2><p>优化上面的CalcScreenSize.jsx组件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'prop-types'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Actions <span class="keyword">from</span> <span class="string">'./Action'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> DOMEventUtil <span class="keyword">from</span> <span class="string">'../public/DOMEventUtil'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; EventTarget &#125; <span class="keyword">from</span> <span class="string">'../public/screenSizeChangeEvent'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CalcScreenSize</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; changeScreenSize &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    DOMEventUtil.addHandler(<span class="built_in">window</span>, <span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      changeScreenSize(<span class="built_in">window</span>.innerWidth, <span class="built_in">window</span>.innerHeight);</span><br><span class="line">    &#125;);</span><br><span class="line">    DOMEventUtil.addHandler(<span class="built_in">window</span>, <span class="string">'resize'</span>, () =&gt; &#123;</span><br><span class="line">      changeScreenSize(<span class="built_in">window</span>.innerWidth, <span class="built_in">window</span>.innerHeight);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">const</span> eventTarget = <span class="keyword">new</span> EventTarget();</span><br><span class="line">    eventTarget.execute(&#123; <span class="attr">type</span>: <span class="string">'echartsResize'</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidUpdate() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; widthSize, heightSize &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">const</span> eventTarget = <span class="keyword">new</span> EventTarget();</span><br><span class="line">    eventTarget.execute(&#123; <span class="attr">type</span>: <span class="string">'echartsResize'</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CalcScreenSize.propTypes = &#123;</span><br><span class="line">  changeScreenSize: PropTypes.func.isRequired,</span><br><span class="line">  widthSize: PropTypes.number.isRequired,</span><br><span class="line">  heightSize: PropTypes.number.isRequired</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    widthSize: state.calcScreenSize.widthSize,</span><br><span class="line">    heightSize: state.calcScreenSize.heightSize</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    changeScreenSize: <span class="function">(<span class="params">widthSize, heightSize</span>) =&gt;</span> &#123;</span><br><span class="line">      dispatch(Actions.changeScreenSize(widthSize, heightSize));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps, mapDispatchToProps)(CalcScreenSize);</span><br></pre></td></tr></table></figure></p>
<p>每当页面大小改变，便会触发发布者执行主题接口中已注册订阅者的相关命令</p>
<h2 id="观察者（订阅者）"><a href="#观察者（订阅者）" class="headerlink" title="观察者（订阅者）"></a>观察者（订阅者）</h2><p>优化上面的DMMap.jsx，使它成为观察者<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PropTypes &#125; <span class="keyword">from</span> <span class="string">'prop-types'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Actions <span class="keyword">from</span> <span class="string">'./Action'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; EventTarget &#125; <span class="keyword">from</span> <span class="string">'../public/screenSizeChangeEvent'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DMMap</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 初始化</span></span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      myCharts: <span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">this</span>.mapShow = <span class="keyword">this</span>.mapShow.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">const</span> mapDiv = <span class="built_in">document</span>.getElementById(<span class="string">'fileInfoMapShow'</span>);</span><br><span class="line">    <span class="keyword">const</span> myCharts = echarts.init(mapDiv);</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      myCharts</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> eventTarget = <span class="keyword">new</span> EventTarget(); <span class="comment">// 获取主题</span></span><br><span class="line">    eventTarget.addHandler(<span class="string">'echartsResize'</span>, myCharts.resize); <span class="comment">// 将发布者广播时调用的方法设置为Echarts的resize</span></span><br><span class="line">    <span class="keyword">this</span>.mapShow(myCharts);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; myCharts &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="keyword">this</span>.mapShow(myCharts);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mapShow(myCharts) &#123; <span class="comment">// 为了只描述大小自适应，已将其他依赖参数删除</span></span><br><span class="line">    <span class="keyword">const</span> option = &#123;</span><br><span class="line">      <span class="comment">// ...省略配置参数信息</span></span><br><span class="line">    &#125;;</span><br><span class="line">    myCharts.clear();</span><br><span class="line">    myCharts.setOption(option);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; heightSize &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div id=<span class="string">"fileInfoMapShow"</span> style=&#123;&#123; <span class="attr">height</span>: <span class="string">`<span class="subst">$&#123;heightSize <span class="regexp">/ 12 * 10&#125;px`, width: '100%' &#125;&#125;&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">        等待地图加载</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">      &lt;/</span>div&gt;</span></span></span><br><span class="line"><span class="string"><span class="subst">    );</span></span></span><br><span class="line"><span class="string"><span class="subst">  &#125;</span></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">DMMap.propTypes = &#123;</span></span><br><span class="line"><span class="string">  heightSize: PropTypes.number.isRequired</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">function mapStateToProps(state) &#123;</span></span><br><span class="line"><span class="string">  return &#123;</span></span><br><span class="line"><span class="string">    heightSize: state.calcScreenSize.heightSize</span></span><br><span class="line"><span class="string">  &#125;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">export default connect(mapStateToProps)(DMMap);</span></span><br></pre></td></tr></table></figure></p>
<p>把Echarts的<code>resize</code>方法作为观察者模式当中的<code>update</code>函数。</p>
<h2 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h2><p>通过这种方式，完成了对JS中事件的封装，使得每个想要实现自适应的组件只要注册就可以实现自身自适应函数的调用。</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>JavaScript高级程序设计</p>
</div><div class="tags"><a href="/tags/js/">js</a><a href="/tags/React/">React</a></div><div class="license-space"></div><div class="license-content"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png"></a><span>本作品采用</span><a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">'知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议'</a><span>进行许可。</span></div><div class="license-space"></div><div class="post-nav"><a class="next" href="/2018/12/29/JS-参数对象新增方法/">JS-参数对象新增方法</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/FreshMan/">FreshMan</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Whisper/">Whisper</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后台/">后台</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构/">架构</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/OGG/" style="font-size: 10px;">OGG</a> <a href="/tags/Echarts/" style="font-size: 16.5px;">Echarts</a> <a href="/tags/Hexo/" style="font-size: 19.75px;">Hexo</a> <a href="/tags/js/" style="font-size: 23px;">js</a> <a href="/tags/Java/" style="font-size: 13.25px;">Java</a> <a href="/tags/源码/" style="font-size: 10px;">源码</a> <a href="/tags/React/" style="font-size: 19.75px;">React</a> <a href="/tags/ESLint/" style="font-size: 13.25px;">ESLint</a> <a href="/tags/Linux/" style="font-size: 13.25px;">Linux</a> <a href="/tags/GitHub/" style="font-size: 16.5px;">GitHub</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/Docker/" style="font-size: 13.25px;">Docker</a> <a href="/tags/Oracle/" style="font-size: 16.5px;">Oracle</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/Python/" style="font-size: 16.5px;">Python</a> <a href="/tags/lambda/" style="font-size: 10px;">lambda</a> <a href="/tags/svn/" style="font-size: 13.25px;">svn</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/设计/" style="font-size: 13.25px;">设计</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/01/02/JS-自定义事件触发在React中使用-高度自适应例/">JS-自定义事件触发在React中使用-高度自适应例</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/29/JS-参数对象新增方法/">JS-参数对象新增方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/17/JS-创建对象/">JS-创建对象</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/02/JS-bind方法参数分析/">JS-bind方法参数分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/01/OGG+Kafka-集群重启记/">OGG+Kafka-集群重启记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/10/Docker-入门基础使用/">Docker-入门基础使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/29/JS-var、let、const/">JS-var、let、const</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/ESLint-安装、airbnb配置与sublimeText3插件/">ESLint-安装、airbnb配置与sublimeText3插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/16/阿里云使用记-ECS/">阿里云使用记-ECS</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/10/JDK源码阅读记-Object/">JDK源码阅读记-Object</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://strcpy.me/" title="strcpy" target="_blank">strcpy</a><ul></ul><a href="https://www.haomwei.com/" title="tufu9441" target="_blank">tufu9441</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">一点知识.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '24bfbdc1d2098a8d5cb427714572bbd5';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>